import cv2
import numpy as np
import os
import tensorflow as tf
from random import shuffle
from tqdm import tqdm
from glob import glob
from pathlib import Path
import matplotlib.pyplot as plt
%matplotlib inline
from PIL import Image
from matplotlib import figure
plt.rcParams['figure.figsize'] = (10, 10)
from tensorflow.python import debug as tf_debug

TRAIN_DIR = 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train'
TEST_DIR = 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\test'
IMG_SIZE = 50
LR = 0.001

def label_img(img):
    word_label = img.split('.')[-2]
    if word_label == 'car': return [1,0]
    elif word_label == 'plane': return [0,1]

def create_train_data():
    training_data = []
    for img in tqdm(os.listdir(TRAIN_DIR)):
        train_label = label_img(img)
        path = os.path.join(TRAIN_DIR,img)
        img = cv2.imread(path)
        img = cv2.resize(img, (IMG_SIZE,IMG_SIZE))
        training_data.append([np.array(img),np.array(train_label)])
    shuffle(training_data)
    np.save('train_data.npy', training_data)
    return training_data

def create_test_data():
    testing_data = []
    for img in tqdm(os.listdir(TEST_DIR)):
        test_label = label_img(img)
        path = os.path.join(TEST_DIR,img)
        img = cv2.imread(path)
        img = cv2.resize(img, (IMG_SIZE,IMG_SIZE))
        testing_data.append([np.array(img),np.array(test_label)])
    shuffle(testing_data)
    np.save('test_data.npy', testing_data)
    return testing_data

train_data = create_train_data()
100%|�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??| 32/32 [00:00<00:00, 561.41it/s]

test_data = create_test_data()
100%|�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??�??| 8/8 [00:00<00:00, 615.55it/s]

train_label = np.load('train_data.npy')
train_label

array([[array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        ...,
        [  5,   5,   5],
        [  4,   4,   4],
        [ 14,  14,  14]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        ...,
        [ 64,  64,  64],
        [  5,   5,   5],
        [  9,   9,   9]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        ...,
        [104, 104, 104],
        [146, 146, 146],
        [  0,   0,   0]],

       ...,

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        ...,
        [ 76,  76,  76],
        [253, 253, 253],
        [175, 175, 175]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        ...,
        [  0,   0,   0],
        [  0,   0,   0],
        [  2,   2,   2]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        ...,
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        ...,
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        ...,
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        ...,
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[  3,   3,   3],
        [  0,   0,   0],
        [  0,   0,   0],
        ...,
        [  4,   4,   4],
        [  1,   1,   1],
        [  6,   6,   6]],

       [[194, 194, 194],
        [  1,   1,   1],
        [  0,   0,   0],
        ...,
        [  2,   2,   2],
        [  1,   1,   1],
        [  5,   5,   5]],

       [[  1,   1,   1],
        [  2,   2,   2],
        [  0,   0,   0],
        ...,
        [  0,   0,   0],
        [  0,   0,   0],
        [ 11,  11,  11]],

       ...,

       [[253, 253, 253],
        [253, 253, 253],
        [250, 250, 250],
        ...,
        [130, 130, 130],
        [252, 252, 252],
        [246, 246, 246]],

       [[252, 252, 252],
        [218, 218, 218],
        [255, 255, 255],
        ...,
        [179, 179, 179],
        [254, 254, 254],
        [253, 253, 253]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [247, 247, 247],
        [255, 255, 255],
        [255, 255, 255]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [254, 254, 254],
        [239, 239, 239]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [148, 148, 148],
        [209, 209, 209],
        [ 82,  82,  82]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [254, 254, 254]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [254, 254, 254]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [254, 254, 254],
        [  1,   1,   1]],

       ...,

       [[246, 246, 246],
        [222, 222, 222],
        [251, 251, 251],
        ...,
        [148, 148, 148],
        [ 94,  94,  94],
        [183, 183, 183]],

       [[240, 240, 240],
        [252, 252, 252],
        [250, 250, 250],
        ...,
        [160, 160, 160],
        [ 45,  45,  45],
        [ 46,  46,  46]],

       [[239, 239, 239],
        [253, 253, 253],
        [ 91,  91,  91],
        ...,
        [179, 179, 179],
        [  9,   9,   9],
        [240, 240, 240]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[247, 247, 247],
        [253, 253, 253],
        [244, 244, 244],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [ 47,  47,  47],
        [ 95,  95,  95],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [254, 254, 254],
        [248, 248, 248],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[  4,   4,   4],
        [  6,   6,   6],
        [  1,   1,   1],
        ...,
        [  0,   0,   0],
        [  4,   4,   4],
        [  2,   2,   2]],

       [[197, 197, 197],
        [  1,   1,   1],
        [  1,   1,   1],
        ...,
        [  6,   6,   6],
        [  0,   0,   0],
        [  3,   3,   3]],

       [[ 15,  15,  15],
        [  0,   0,   0],
        [  0,   0,   0],
        ...,
        [ 11,  11,  11],
        [  1,   1,   1],
        [  1,   1,   1]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [  5,   5,   5],
        [  3,   3,   3],
        [ 16,  16,  16]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [ 64,  64,  64],
        [176, 176, 176],
        [  6,   6,   6]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [ 24,  24,  24],
        [148, 148, 148],
        [ 17,  17,  17]],

       ...,

       [[ 11,  11,  11],
        [ 14,  14,  14],
        [ 56,  56,  56],
        ...,
        [  0,   0,   0],
        [  3,   3,   3],
        [  3,   3,   3]],

       [[  3,   3,   3],
        [174, 174, 174],
        [  1,   1,   1],
        ...,
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  1,   1,   1],
        [ 13,  13,  13],
        [ 12,  12,  12],
        ...,
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[ 82,  82,  82],
        [192, 192, 192],
        [229, 229, 229],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[199, 199, 199],
        [ 85,  85,  85],
        [160, 160, 160],
        ...,
        [255, 255, 255],
        [250, 250, 250],
        [247, 247, 247]],

       [[  1,   1,   1],
        [  0,   0,   0],
        [  5,   5,   5],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [248, 248, 248]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [ 87,  87,  87],
        [211, 211, 211],
        [ 36,  36,  36]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [221, 221, 221],
        [ 81,  81,  81],
        [212, 212, 212]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [131, 131, 131],
        [108, 108, 108],
        [ 87,  87,  87]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [250, 250, 250],
        [254, 254, 254],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [ 93,  93,  93],
        [253, 253, 253],
        [239, 239, 239]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [123, 123, 123],
        [ 94,  94,  94],
        [  5,   5,   5]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [110, 110, 110],
        [ 10,  10,  10],
        [  4,   4,   4]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [  5,   5,   5],
        [196, 196, 196],
        [ 17,  17,  17]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[254, 254, 254],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [254, 254, 254],
        [251, 251, 251]],

       [[  6,   6,   6],
        [209, 209, 209],
        [254, 254, 254],
        ...,
        [240, 240, 240],
        [ 85,  85,  85],
        [254, 254, 254]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        ...,
        [253, 253, 253],
        [249, 249, 249],
        [250, 250, 250]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[ 86,  86,  86],
        [191, 191, 191],
        [201, 201, 201],
        ...,
        [149, 149, 149],
        [189, 189, 189],
        [255, 255, 255]],

       [[252, 252, 252],
        [217, 217, 217],
        [160, 160, 160],
        ...,
        [235, 235, 235],
        [255, 255, 255],
        [255, 255, 255]],

       [[246, 246, 246],
        [192, 192, 192],
        [ 87,  87,  87],
        ...,
        [252, 252, 252],
        [246, 246, 246],
        [249, 249, 249]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[236, 236, 236],
        [210, 210, 210],
        [ 92,  92,  92],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[247, 247, 247],
        [214, 214, 214],
        [238, 238, 238],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[168, 168, 168],
        [160, 160, 160],
        [128, 128, 128],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [251, 251, 251],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [246, 246, 246],
        [251, 251, 251],
        [ 29,  29,  29]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [249, 249, 249],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [103, 103, 103],
        [192, 192, 192],
        [ 86,  86,  86]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [192, 192, 192],
        [212, 212, 212],
        [ 55,  55,  55]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [ 76,  76,  76],
        [206, 206, 206],
        [251, 251, 251]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [254, 254, 254],
        [248, 248, 248]],

       [[255, 255, 255],
        [254, 254, 254],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [251, 251, 251]],

       [[ 13,  13,  13],
        [178, 178, 178],
        [200, 200, 200],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [201, 201, 201],
        [218, 218, 218],
        [244, 244, 244]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [ 94,  94,  94],
        [218, 218, 218],
        [ 58,  58,  58]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [250, 250, 250],
        [242, 242, 242],
        [254, 254, 254]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [  4,   4,   4],
        [  9,   9,   9],
        [  3,   3,   3]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [ 14,  14,  14],
        [  0,   0,   0],
        [210, 210, 210]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [ 54,  54,  54],
        [  1,   1,   1],
        [  7,   7,   7]],

       ...,

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        ...,
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        ...,
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        ...,
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]]], dtype=uint8),
        array(None, dtype=object)]], dtype=object)
In [179]:
test_label = np.load('test_data.npy')
test_label
Out[179]:
array([[array([[[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        ...,
        [ 80,  80,  80],
        [199, 199, 199],
        [ 28,  28,  28]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        ...,
        [ 78,  78,  78],
        [217, 217, 217],
        [  3,   3,   3]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        ...,
        [ 58,  58,  58],
        [157, 157, 157],
        [ 80,  80,  80]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [250, 250, 250],
        [246, 246, 246]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [253, 253, 253],
        [211, 211, 211]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [241, 241, 241]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        ...,
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        ...,
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[ 13,  13,  13],
        [  2,   2,   2],
        [  0,   0,   0],
        ...,
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       ...,

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[254, 254, 254],
        [240, 240, 240],
        [131, 131, 131],
        ...,
        [177, 177, 177],
        [ 95,  95,  95],
        [165, 165, 165]],

       [[212, 212, 212],
        [ 83,  83,  83],
        [188, 188, 188],
        ...,
        [ 95,  95,  95],
        [218, 218, 218],
        [ 55,  55,  55]],

       [[254, 254, 254],
        [242, 242, 242],
        [240, 240, 240],
        ...,
        [246, 246, 246],
        [ 59,  59,  59],
        [220, 220, 220]]], dtype=uint8),
        array(None, dtype=object)],
       [array([[[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       ...,

       [[244, 244, 244],
        [251, 251, 251],
        [200, 200, 200],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[212, 212, 212],
        [ 83,  83,  83],
        [240, 240, 240],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]],

       [[253, 253, 253],
        [204, 204, 204],
        [248, 248, 248],
        ...,
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255]]], dtype=uint8),
        array(None, dtype=object)]], dtype=object)
In [180]:
x_train = np.zeros((32,256,256))
x_test = np.zeros((8,256,256))
y_train = os.listdir(TRAIN_DIR)
y_test = os.listdir(TEST_DIR)
y_train = [os.path.join(TRAIN_DIR, file) for file in y_train]
y_test = [os.path.join(TEST_DIR, file) for file in y_test]
In [193]:
for confile, file in enumerate(y_train):
    x_train[confile,:,:] = np.asarray(Image.open(file))
for confile,file in enumerate(y_test):
    x_test[confile,:,:] = np.asarray(Image.open(file))
x_train = x_train/255.0
x_test = x_test/255.0
features = {"x": x_train}
labels = y_train
In [190]:
print("Values :")
x_train
X Train Values :
Out[190]:
array([[[255., 255., 255., ..., 255., 255., 255.],
        [255., 255., 255., ..., 255., 255., 255.],
        [255., 255., 255., ..., 255., 255., 255.],
        ...,
        [  1.,  15., 238., ..., 255.,   1., 249.],
        [  0.,   0., 255., ...,   0., 248.,   2.],
        [  0.,  13., 246., ..., 255.,   0., 255.]],

       [[255., 255., 255., ..., 255., 255., 255.],
        [255., 255., 255., ..., 255., 255., 255.],
        [255., 255., 255., ..., 255., 255., 255.],
        ...,
        [255., 255., 255., ..., 255., 255., 255.],
        [255., 255., 255., ..., 255., 255., 255.],
        [255., 255., 255., ..., 255., 255., 255.]],

       [[255., 255., 255., ..., 253., 255., 253.],
        [255., 255., 255., ..., 255., 249.,   0.],
        [255., 255., 255., ..., 247., 255., 255.],
        ...,
        [255., 255., 255., ..., 255., 240., 255.],
        [255., 255., 255., ..., 242.,   4., 247.],
        [255., 255., 255., ..., 255., 255., 255.]],

       ...,

       [[255., 255., 255., ..., 255., 255., 255.],
        [255., 255., 255., ..., 255., 255., 255.],
        [255., 255., 255., ..., 255., 255., 255.],
        ...,
        [255., 255., 255., ..., 252.,   3., 255.],
        [255., 255., 255., ...,   0., 255., 249.],
        [255., 255., 255., ...,   0., 255.,   0.]],

       [[255., 255., 255., ..., 253., 248., 255.],
        [255., 255., 255., ..., 252.,  13., 246.],
        [255., 255., 255., ...,   8., 243., 255.],
        ...,
        [255., 255., 255., ..., 253., 253., 255.],
        [255., 255., 255., ..., 252., 255., 234.],
        [255., 255., 255., ..., 255., 255., 255.]],

       [[255., 255., 255., ..., 255., 255., 255.],
        [255., 255., 255., ..., 255., 255., 255.],
        [255., 255., 255., ..., 255., 255., 255.],
        ...,
        [255., 255., 247., ..., 249., 255., 255.],
        [248.,   4., 255., ..., 255., 255., 244.],
        [255., 254., 255., ..., 244., 255., 255.]]])
In [158]:
print("Images Path Taken : ")
labels
Images Path Taken :
Out[158]:
['C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\car.01.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\car.02.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\car.03.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\car.04.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\car.05.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\car.06.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\car.07.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\car.08.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\car.09.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\car.10.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\car.11.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\car.12.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\car.13.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\car.14.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\car.15.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\car.16.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\plane.01.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\plane.02.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\plane.03.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\plane.04.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\plane.05.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\plane.06.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\plane.07.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\plane.08.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\plane.09.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\plane.10.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\plane.15.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\plane.16.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\plane.17.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\plane.18.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\plane.19.jpg',
 'C:\\Users\\adari\\Documents\\image_classification\\cars_planes\\train\\plane.20.jpg']
In [97]:
def conv2D(inputs, filters=16 ):
    return tf.layers.conv2d(inputs=inputs,
                            filters=filters,
                            kernel_size=[5,5],
                            padding='SAME',
                           activation='relu')
In [98]:
def dense(inputs, units=256):
    return tf.layers.dense(inputs=inputs,
                          units=units,
                          activation=tf.nn.relu)
In [99]:
def logits(inputs):
    return tf.layers.dense(inputs=inputs, units=2)
In [100]:
def globalaveragepooling(inputs):
    return tf.keras.layers.GlobalAveragePooling2D()(inputs)
In [127]:
def cnn_model_fn(features, labels, mode):
    # Input Layer
    input_layer = tf.reshape(features["x"], [-1, 256, 256, 1])

    # Convolutional Layer #1
    conv1 = tf.layers.conv2d(
        inputs=input_layer,
        filters=32,
        kernel_size=[5, 5],
        padding="same",
        activation=tf.nn.relu)

    # Pooling Layer #1
    pool1 = tf.layers.max_pooling2d(inputs=conv1, pool_size=[2, 2], strides=2)

    # Convolutional Layer #2 and Pooling Layer #2
    conv2 = tf.layers.conv2d(
        inputs=pool1,
        filters=64,
        kernel_size=[5, 5],
        padding="same",
        activation=tf.nn.relu)
    pool2 = tf.layers.max_pooling2d(inputs=conv2, pool_size=[2, 2], strides=2)

    # Dense Layer
    pool2_flat = tf.reshape(pool2, [-1, 7 * 7 * 64])
    dense = tf.layers.dense(inputs=pool2_flat, units=1024, activation=tf.nn.relu)
    dropout = tf.layers.dropout(
        inputs=dense, rate=0.4, training=mode == tf.estimator.ModeKeys.TRAIN)

    # Logits Layer
    logits = tf.layers.dense(inputs=dropout, units=10)

    predictions = {
        # Generate predictions (for PREDICT and EVAL mode)
        "classes": tf.argmax(input=logits, axis=1),
        # Add `softmax_tensor` to the graph. It is used for PREDICT and by the
        # `logging_hook`.
        "probabilities": tf.nn.softmax(logits, name="softmax_tensor")
    }

    if mode == tf.estimator.ModeKeys.PREDICT:
        return tf.estimator.EstimatorSpec(mode=mode, predictions=predictions)

    # Calculate Loss (for both TRAIN and EVAL modes)
    tf.arg_max(labels,x_train)
    loss = tf.losses.sparse_softmax_cross_entropy(labels=labels, logits=logits)

    # Configure the Training Op (for TRAIN mode)
    if mode == tf.estimator.ModeKeys.TRAIN:
        optimizer = tf.train.GradientDescentOptimizer(LR)
        train_op = optimizer.minimize(
            loss=loss,
            global_step=tf.train.get_global_step())
    return tf.estimator.EstimatorSpec(mode=mode, loss=loss, train_op=train_op)

    # Add evaluation metrics (for EVAL mode)
    eval_metric_ops = {
        "accuracy": tf.metrics.accuracy(
            labels=labels, predictions=predictions["classes"])}
    return tf.estimator.EstimatorSpec(
        mode=mode, loss=loss, eval_metric_ops=eval_metric_ops)
In [132]:
# Train the model
carplane_classifier = tf.estimator.Estimator(model_fn=cnn_model_fn, model_dir="C:\\tmp\\tensorflow\\mnist\\input_data")

train_input_fn = tf.estimator.inputs.numpy_input_fn(
    x={"x": x_train},
    y=y_train,
    batch_size=1,
    num_epochs=10,
    shuffle=True)
carplane_classifier.train(
    input_fn=train_input_fn,
    steps=100,
    hooks=[logging_hook])

x_train.shape
x_test.shape
y_train.shape
y_test.shape

# Evaluate the model and print results
eval_input_fn = tf.estimator.inputs.numpy_input_fn(
    x={"x": x_test},
    y=y_test,
    num_epochs=1,
    shuffle=False)
eval_results = carplane_classifier.evaluate(input_fn=eval_input_fn)
print(eval_results)
INFO:tensorflow:Using default config.
INFO:tensorflow:Using config: {'_model_dir': 'C:\\tmp\\tensorflow\\mnist\\input_data', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': None, '_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
graph_options {
  rewrite_options {
    meta_optimizer_iterations: ONE
  }
}
, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': None, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x000002D64451AAC8>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master': '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-132-bea52d1b2183> in <module>()
     11     input_fn=train_input_fn,
     12     steps=100,
---> 13     hooks=[logging_hook])
     14
     15 x_train.shape

~\Anaconda3\lib\site-packages\tensorflow\python\estimator\estimator.py in train(self, input_fn, hooks, steps, max_steps, saving_listeners)
    354
    355       saving_listeners = _check_listeners_type(saving_listeners)
--> 356       loss = self._train_model(input_fn, hooks, saving_listeners)
    357       logging.info('Loss for final step: %s.', loss)
    358       return self

~\Anaconda3\lib\site-packages\tensorflow\python\estimator\estimator.py in _train_model(self, input_fn, hooks, saving_listeners)
   1179       return self._train_model_distributed(input_fn, hooks, saving_listeners)
   1180     else:
-> 1181       return self._train_model_default(input_fn, hooks, saving_listeners)
   1182
   1183   def _train_model_default(self, input_fn, hooks, saving_listeners):

~\Anaconda3\lib\site-packages\tensorflow\python\estimator\estimator.py in _train_model_default(self, input_fn, hooks, saving_listeners)
   1206       features, labels, input_hooks = (
   1207           self._get_features_and_labels_from_input_fn(
-> 1208               input_fn, model_fn_lib.ModeKeys.TRAIN))
   1209       worker_hooks.extend(input_hooks)
   1210       estimator_spec = self._call_model_fn(

~\Anaconda3\lib\site-packages\tensorflow\python\estimator\estimator.py in _get_features_and_labels_from_input_fn(self, input_fn, mode)
   1047     """Extracts the `features` and labels from return values of `input_fn`."""
   1048     return estimator_util.parse_input_fn_result(
-> 1049         self._call_input_fn(input_fn, mode))
   1050
   1051   def _extract_batch_length(self, preds_evaluated):

~\Anaconda3\lib\site-packages\tensorflow\python\estimator\estimator.py in _call_input_fn(self, input_fn, mode)
   1134       kwargs['config'] = self.config
   1135     with ops.device('/cpu:0'):
-> 1136       return input_fn(**kwargs)
   1137
   1138   def _call_model_fn(self, features, labels, mode, config):

~\Anaconda3\lib\site-packages\tensorflow\python\estimator\inputs\numpy_io.py in input_fn()
    175       ordered_dict_data[target_keys] = y
    176
--> 177     if len(set(v.shape[0] for v in ordered_dict_data.values())) != 1:
    178       shape_dict_of_x = {k: ordered_dict_data[k].shape for k in feature_keys}
    179

~\Anaconda3\lib\site-packages\tensorflow\python\estimator\inputs\numpy_io.py in <genexpr>(.0)
    175       ordered_dict_data[target_keys] = y
    176
--> 177     if len(set(v.shape[0] for v in ordered_dict_data.values())) != 1:
    178       shape_dict_of_x = {k: ordered_dict_data[k].shape for k in feature_keys}
    179

AttributeError: 'list' object has no attribute 'shape'
